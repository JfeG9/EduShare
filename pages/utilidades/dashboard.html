<!DOCTYPE html>
<html lang="es">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>EduShare - Inicio</title>
        <link rel="shortcut icon" type="image/x-icon" href="../../favicon.ico"/>
        <link rel="stylesheet" href="../../css/dashboard.css" />
    </head>
    <body>
        <header class="top-bar">
            <div class="logo-box">
                <i data-lucide="menu" class="top-icon"></i>
                <img src="../../assets/img/logo.png" alt="EduShare" class="logo" id="logo"/>
            </div>

            <div class="top-icons">
                <i data-lucide="download" class="top-icon"></i>
                <i id="btnTheme" data-lucide="sun" class="top-icon"></i>
                <i data-lucide="calendar-days" class="top-icon"></i>
                <i data-lucide="bell" class="top-icon"></i>
                <i id="btnSettings" data-lucide="settings" class="top-icon"></i>
            </div>
        </header>

        <aside class="right-menu">
            <div class="side-card">
                <span>Cerrar sesión</span>
                <button id="btnCerrarSesion">Salir</button>
            </div>
        </aside>

        <main class="main-content">
            <section class="profile-banner">
                <div class="banner-inner">
                    <div class="profile-avatar"></div>
                    <div>
                        <h2 id="username" class="username"></h2>
                        <p class="stats">
                            0 publicaciones · 0 seguidores · 0 seguidos
                        </p>
                    </div>
                </div>
            </section>

            <section class="content-area">
                <p class="welcome-text">
                    Prepárate para ser parte de la comunidad en esta plataforma
                    de estudio N°1 del Perú
                </p>

                <div class="action-buttons">
                    <a href="../busqueda/busqueda.html">
                        <button class="action-btn">Buscar material</button>
                    </a>
                    <a href="#">
                        <button class="action-btn">Gestión de materiales</button>
                    </a>
                    <a href="#">
                        <button class="action-btn">Registro de licencias</button>
                    </a>
                </div>

                <h3 class="faq-title">Preguntas Frecuentes:</h3>

                <section class="faq-panel">
                    <details>
                        <summary>¿Puedo iniciar sesión con cualquier correo?</summary>
                        <p>
                            Sí, puedes usar tanto tu correo personal como institucional.
                            Ambos te brindan acceso gratuito a la plataforma.
                        </p>
                    </details>

                    <details>
                        <summary>¿Qué es el registro gratuito mejorado?</summary>
                        <p>
                            Es una actualización de tu cuenta actual con funciones adicionales.
                        </p>
                    </details>

                    <details>
                        <summary>¿La plataforma tiene una app oficial?</summary>
                        <p>
                            Próximamente se lanzarán versiones móviles con herramientas premium.
                        </p>
                    </details>
                </section>

                <!-- ==========================
                     SECCIÓN PARA SUBIR Y VER PDF
                =========================== -->
                <section class="pdf-section" style="margin-top: 40px; padding: 20px; background:#f6f6f6; border-radius:12px;">
                    <h3>Visor de PDF</h3>

                    <input type="file" id="pdfUploader" accept="application/pdf" style="margin-bottom: 15px;" />

                    <iframe id="pdfViewer"
                        style="width: 100%; height: 500px; border: 1px solid #ccc; border-radius: 10px;">
                    </iframe>
                </section>
            </section>
        </main>

        <footer class="main-footer">
            <div class="footer-column">
                <h4>Contáctanos</h4>
                <p>Teléfono: 01 211111</p>
                <p>Whatsapp: +51 999 888 777</p>
                <p>Whatsapp: +51 999 777 665</p>
            </div>
            <div class="footer-column">
                <h4>Nuestras redes sociales</h4>
                <p>Instagram · Facebook · Twitter</p>
            </div>
            <div class="footer-column">
                <h4>Empresa</h4>
                <a href="#">Sobre Nosotros</a>
                <a href="#">FAQ</a>
                <a href="#">Novedades</a>
            </div>
            <div class="footer-column">
                <h4>Políticas</h4>
                <a href="#">Condiciones</a>
                <a href="#">Privacidad</a>
                <a href="#">Configuración de Cookies</a>
            </div>
        </footer>

        <script src="https://unpkg.com/lucide@latest"></script>
        <script>lucide.createIcons();</script>

        <script src="../../js/dashboard.js"></script>

        <!-- ==========================
             JS DEL VISOR DE PDF
        =========================== -->
        <script>
            const pdfUploader = document.getElementById("pdfUploader");
            const pdfViewer   = document.getElementById("pdfViewer");

            // ============================
            // 1. Si NO existe un PDF guardado, cargar Informe_DD1.pdf automáticamente
            // ============================
            if (!localStorage.getItem("pdfGuardado")) {
                fetch("../../assets/pdf/Informe_DD1.pdf")
                    .then(res => res.blob())
                    .then(blob => {
                        const reader = new FileReader();

                        reader.onload = function (e) {
                            const base64PDF = e.target.result;
                            localStorage.setItem("pdfGuardado", base64PDF); 
                            pdfViewer.src = base64PDF;
                        };

                        reader.readAsDataURL(blob);
                    })
                    .catch(err =>
                        console.error("No se pudo cargar Informe_DD1.pdf:", err)
                    );
            }

            // ============================
            // 2. Mostrar PDF guardado (si existe)
            // ============================
            const savedPDF = localStorage.getItem("pdfGuardado");
            if (savedPDF) {
                pdfViewer.src = savedPDF;
            }

            // ============================
            // 3. Subir y reemplazar PDF manualmente
            // ============================
            pdfUploader.addEventListener("change", () => {
                const file = pdfUploader.files[0];
                if (!file) return;

                const reader = new FileReader();

                reader.onload = (e) => {
                    const base64PDF = e.target.result;
                    localStorage.setItem("pdfGuardado", base64PDF);
                    pdfViewer.src = base64PDF;
                };

                reader.readAsDataURL(file);
            });
        </script>
    </body>
</html>
